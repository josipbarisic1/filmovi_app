<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <title>Moji Popisi</title>
    <link rel="stylesheet" href="/css/popisi.css">
</head>
<body>

    <%- include('partials/header') %>

    <h1>My Lists</h1>

    <form action="/popisi/kreiraj" method="POST">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
        <input type="text" name="naziv" placeholder="Naziv popisa" required>
        <select name="tip_popisa">
            <option value="filmovi">Movies</option>
            <option value="serije">TV Shows</option>
            <option value="mixed">Mixed</option>
        </select>
        <button type="submit" class="create-list">Create List</button>
    </form>

    <h2>Movies</h2>
    <% popisi.filter(p => p.tip_popisa === 'filmovi').forEach(popis => { %>
        <div class="list-card">
            <h3><a href="/popisi/<%= popis.id %>"><%= popis.naziv %></a></h3>
            <p><strong>Items:</strong> <%= popis.broj_stavki %></p>
            <p><strong>Created:</strong> <%= new Date(popis.created_at).toLocaleDateString() %></p>
            <form action="/popisi/obrisi" method="POST" onsubmit="return confirm('Are you sure you want to delete this list?');">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                <input type="hidden" name="popis_id" value="<%= popis.id %>">
                <button type="submit" class="delete-list">Delete List</button>
            </form>
        </div>
    <% }) %>

    <h2>TV Shows</h2>
    <% popisi.filter(p => p.tip_popisa === 'serije').forEach(popis => { %>
        <div class="list-card">
            <h3><a href="/popisi/<%= popis.id %>"><%= popis.naziv %></a></h3>
            <p><strong>Items:</strong> <%= popis.broj_stavki %></p>
            <p><strong>Created:</strong> <%= new Date(popis.created_at).toLocaleDateString() %></p>
            <form action="/popisi/obrisi" method="POST" onsubmit="return confirm('Are you sure you want to delete this list?');">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                <input type="hidden" name="popis_id" value="<%= popis.id %>">
                <button type="submit" class="delete-list">Delete List</button>
            </form>
        </div>
    <% }) %>

    <h2>Mixed</h2>
    <% popisi.filter(p => p.tip_popisa === 'mixed').forEach(popis => { %>
        <div class="list-card">
            <h3><a href="/popisi/<%= popis.id %>"><%= popis.naziv %></a></h3>
            <p><strong>Items:</strong> <%= popis.broj_stavki %></p>
            <p><strong>Created:</strong> <%= new Date(popis.created_at).toLocaleDateString() %></p>
            <form action="/popisi/obrisi" method="POST" onsubmit="return confirm('Are you sure you want to delete this list?');">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                <input type="hidden" name="popis_id" value="<%= popis.id %>">
                <button type="submit" class="delete-list">Delete List</button>
            </form>
        </div>
    <% }) %>


    <%- include('partials/footer') %>

</body>
</html>